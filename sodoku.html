<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Sudoku web</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
</head>


<p> SUDOKU GAME grop7</p>



<body>
  <script>


    let data;
    let matrix = [];
    let cell;
    const boardWidth = 450;
    const boardHeight = 450;


    // let matrix = [
    // [0, 7, 3, 0, 0, 0, 0, 6, 0],
    // [0, 0, 4, 0, 7, 0, 0, 0, 1],
    //[0, 0, 2, 8, 0, 0, 0, 0, 9],
    // [0, 6, 0, 0, 0, 0, 0, 0, 0],
    // [8, 0, 0, 6, 3, 0, 0, 0, 4],
    // [5, 0, 9, 0, 8, 4, 0, 0, 0],
    // [0, 0, 5, 7, 6, 0, 0, 0, 3],
    // [7, 0, 0, 3, 9, 8, 2, 0, 0],
    //  [0, 1, 0, 0, 5, 0, 6, 0, 0],
    //];


    function preload() {
      data = loadStrings("sudoku.txt");  // ชื่อไฟล์ sudoku.txt
    }





    function setup() {
      createCanvas(600, 600);
      background(255);
      cell = boardWidth / 9;
      console.log(width);
      console.log(height);

      for (let r = 0; r < data.length; r++) {
        let row = data[r].trim().split(" ").map(Number);
        matrix.push(row);
      }

      console.log(matrix); 
    }



    



    function draw() {
      drawTable()
      drawsmalltable()
      drawCellBackground();
      drawNumber()


    }

    function drawTable() {
      //fill(0);
      for (let i = 0; i <= 9; i++) {
        if (i % 3 === 0) {
          strokeWeight(3);
        } else {
          strokeWeight(1);
        }
        line(i * cell, 0, i * cell, boardHeight);
        line(0, i * cell, boardWidth, i * cell);
      }
    }

    function mousePressed() {
      let row = floor(mouseY / cell);
      let col = floor(mouseX / cell);
      console.log(row, col);
      positionOnCanvas()
    }


    function drawsmalltable() {
      line(1, 500, 450, 500);
      line(1, 550, 450, 550);
      for (let j = 0; j <= 9; j++) {
        line(j * cell, 500, j * cell, 550);
      }
      textAlign(CENTER, CENTER);
      textSize(0.4 * cell); //ตัวเลขเล็กลง
      fill(0);
      strokeWeight(1); //ไม่ได้
      for (let k = 0; k < 9; k++) {
        let x = k * cell + cell / 2;
        let y = 525;
        text(k + 1, x, y);
        //ถ้าจะให้เลขมากขึ้น อย่าลืมพิมพ์ ตัวแปร+1
      }

    }

    function positionOnCanvas() {
      let posX = mouseX;
      let posY = mouseY;
      console.log(mouseX, mouseY);
    }



    function drawNumber() {
      textAlign(CENTER, CENTER);
      textSize(0.4 * cell);
      fill(0);
      strokeWeight(1);
      for (r = 0; r < 9; r++) {
        for (c = 0; c < 9; c++) {
          if (matrix[r][c] !== 0) {
            let y = c * cell + cell / 2;
            let x = r * cell + cell / 2;
            text(matrix[r][c], y, x);

          }
        }

      }

    }




    function drawCellBackground() {
      noStroke();
      for (let r = 0; r < 9; r++) {
        for (let c = 0; c < 9; c++) {
          if (matrix[r][c] !== 0) {
            fill(230, 240, 255);
            rect(c * cell + 1, r * cell + 1, cell - 2, cell - 2);
          }
        }
      }
    }

    //ฟังชันคลิกเลือกเลข
    let selectedNumber = null;
    let colorRow = null;
    let colorCol = null;
    function mouseClicked() {
      if (mouseY > 500 && mouseY < 550) {
        selectedNumber = floor(mouseX / cell) + 1;
      }
      else if (mouseY >= 0 && mouseY < 450) {
        inputNumberInaTable();
      }
      console.log(selectedNumber);
    }



    function inputNumberInaTable() {
      let row = floor(mouseY / cell);
      let col = floor(mouseX / cell);
      if (matrix[row][col] === 0 && selectedNumber !== null) {
        if (checkNumber(row, col, selectedNumber)) {
          matrix[row][col] = selectedNumber;
        }
        //colorRow = row;
        //colorCol = col;
      }
      else {
        console.log((matrix))
      }
      console.log(matrix[row][col]);
    }

    function checkNumber(row, col, selectedNumber) {
      //ตรวจแถว
      for (let c = 0; c < 9; c++)
        if (c != col && matrix[row][c] === selectedNumber) {
          return false;
        }
      console.log(c);



      for (let r = 0; r < 9; r++) {
        if (r != row && matrix[r][col] === selectedNumber) {
          return false;
        }
      }

      let startRow = Math.floor(row / 3) * 3;
      let startCol = Math.floor(col / 3) * 3;

      for (let r = startRow; r < startRow + 3; r++) {
        for (let c = startCol; c < startCol + 3; c++) {
          if ((r !== row || c !== col) && matrix[r][c] === selectedNumber) {
            // เช้คกล่อง 3x3 
            return false;
          }
        }
      }
      return true;
    }



  </script>
</body>

</html>